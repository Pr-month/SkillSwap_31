Running 18 tests using 1 worker
  ✓  1 [setup] › global.setup.ts:9:1 › Авторизация, как админ (46ms)
  ✓  2 [setup] › global.setup.ts:33:1 › Авторизация, как пользователь (20ms)
  ✘  3 [api] › tests.spec.ts:7:3 › Проверка на уязвимость пакетов › Аудит backend пакетов (1.2s)
  ✘  4 [api] › tests.spec.ts:18:3 › Проверка заказов › Нормализован лимит (3.1s)
  ✘  5 [api] › tests.spec.ts:29:3 › Проверка заказов › При избыточной аггрегации, уязвимой к инъекции должна быть ошибка (3.0s)
  ✓  6 [api] › tests.spec.ts:38:3 › Проверка заказов › Санитизирован комментарий (3.1s)
  ✘  7 [api] › tests.spec.ts:59:3 › Проверка заказов › Уязвимость телефона (10.0s)
  ✘  8 [api] › tests.spec.ts:77:3 › Проверка заказов › Проверка роли (у пользователя отсутствует доступ к базе всех заказов) (10.0s)
  ✘  9 [api] › tests.spec.ts:94:3 › Проверка пользователей › Нормализован лимит (10.0s)
  ✘  10 [api] › tests.spec.ts:105:3 › Проверка пользователей › Экранирование при поиске (10.0s)
  ✘  11 [api] › tests.spec.ts:114:3 › Проверка пользователей › Проверка роли (у пользователя отсутствует доступ к базе всех пользователей) (10.0s)
  ✘  12 [api] › tests.spec.ts:131:3 › Проверка загрузки файлов › Нельзя использовать оригинальное имя файл при формировании пути (10.0s)
  ✘  13 [api] › tests.spec.ts:157:3 › Проверка загрузки файлов › Размер файлов должен быть лимитирован по минимуму (больше 2kb) (10.0s)
  ✓  14 [api] › tests.spec.ts:177:3 › Проверка загрузки файлов › Размер файлов должен быть лимитирован по максимуму (меньше 10mb) (3.1s)
  ✘  15 [api] › tests.spec.ts:197:3 › Проверка загрузки файлов › Проверка метаданных загружаемого изображения (10.0s)
  ✘  16 [api] › tests.spec.ts:220:3 › Общие проверки › cors() содержит параметры и не пустой (10.0s)
  ✓  17 [api] › tests.spec.ts:229:3 › Общие проверки › Лимит на размер body (3.5s)
  ✘  18 [api] › tests.spec.ts:248:3 › Общие проверки › Установлен рейт-лимит (10.0s)
  1) [api] › tests.spec.ts:7:3 › Проверка на уязвимость пакетов › Аудит backend пакетов ────────────
    Error: expect(received).toEqual(expected) // deep equality
    Expected: 0
    Received: 1
       7 |   test('Аудит backend пакетов', () => {
       8 |     const result = shell.exec('npm audit', { cwd: `${process.env.GITHUB_WORKSPACE}/backend`, silent: true });
    >  9 |     expect(result.code).toEqual(0);
         |                         ^
      10 |   });
      11 | });
      12 |
        at /tmp/tests-bad-server/__tests__/tests.spec.ts:9:25
  2) [api] › tests.spec.ts:18:3 › Проверка заказов › Нормализован лимит ────────────────────────────
    Error: expect(received).toBeLessThanOrEqual(expected)
    Expected: <= 10
    Received:    1000
      24 |     const data = await response.json();
      25 |     expect(response.ok()).toBeTruthy();
    > 26 |     expect(data.pagination.pageSize).toBeLessThanOrEqual(10);
         |                                      ^
      27 |   });
      28 |
      29 |   test('При избыточной аггрегации, уязвимой к инъекции должна быть ошибка', async ({ request }) => {
        at /tmp/tests-bad-server/__tests__/tests.spec.ts:26:38
  3) [api] › tests.spec.ts:29:3 › Проверка заказов › При избыточной аггрегации, уязвимой к инъекции должна быть ошибка 
    Error: expect(received).toBeFalsy()
    Received: true
      33 |       }
      34 |     });
    > 35 |     expect(response.ok()).toBeFalsy();
         |                           ^
      36 |   });
      37 |
      38 |   test('Санитизирован комментарий', async ({ request }) => {
        at /tmp/tests-bad-server/__tests__/tests.spec.ts:35:27
  4) [api] › tests.spec.ts:59:3 › Проверка заказов › Уязвимость телефона ───────────────────────────
    Test timeout of 7000ms exceeded.
  5) [api] › tests.spec.ts:77:3 › Проверка заказов › Проверка роли (у пользователя отсутствует доступ к базе всех заказов) 
    Test timeout of 7000ms exceeded.
  6) [api] › tests.spec.ts:94:3 › Проверка пользователей › Нормализован лимит ──────────────────────
    Test timeout of 7000ms exceeded.
  7) [api] › tests.spec.ts:105:3 › Проверка пользователей › Экранирование при поиске ───────────────
    Test timeout of 7000ms exceeded.
  8) [api] › tests.spec.ts:114:3 › Проверка пользователей › Проверка роли (у пользователя отсутствует доступ к базе всех пользователей) 
    Test timeout of 7000ms exceeded.
  9) [api] › tests.spec.ts:131:3 › Проверка загрузки файлов › Нельзя использовать оригинальное имя файл при формировании пути 
    Test timeout of 7000ms exceeded.
  10) [api] › tests.spec.ts:157:3 › Проверка загрузки файлов › Размер файлов должен быть лимитирован по минимуму (больше 2kb) 
    Test timeout of 7000ms exceeded.
  11) [api] › tests.spec.ts:197:3 › Проверка загрузки файлов › Проверка метаданных загружаемого изображения 
    Test timeout of 7000ms exceeded.
  12) [api] › tests.spec.ts:220:3 › Общие проверки › cors() содержит параметры и не пустой ─────────
    Test timeout of 7000ms exceeded.
  13) [api] › tests.spec.ts:248:3 › Общие проверки › Установлен рейт-лимит ─────────────────────────
    Test timeout of 7000ms exceeded.
  13 failed
    [api] › tests.spec.ts:7:3 › Проверка на уязвимость пакетов › Аудит backend пакетов ─────────────
    [api] › tests.spec.ts:18:3 › Проверка заказов › Нормализован лимит ─────────────────────────────
    [api] › tests.spec.ts:29:3 › Проверка заказов › При избыточной аггрегации, уязвимой к инъекции должна быть ошибка 
    [api] › tests.spec.ts:59:3 › Проверка заказов › Уязвимость телефона ────────────────────────────
    [api] › tests.spec.ts:77:3 › Проверка заказов › Проверка роли (у пользователя отсутствует доступ к базе всех заказов) 
    [api] › tests.spec.ts:94:3 › Проверка пользователей › Нормализован лимит ───────────────────────
    [api] › tests.spec.ts:105:3 › Проверка пользователей › Экранирование при поиске ────────────────
    [api] › tests.spec.ts:114:3 › Проверка пользователей › Проверка роли (у пользователя отсутствует доступ к базе всех пользователей) 
    [api] › tests.spec.ts:131:3 › Проверка загрузки файлов › Нельзя использовать оригинальное имя файл при формировании пути 
    [api] › tests.spec.ts:157:3 › Проверка загрузки файлов › Размер файлов должен быть лимитирован по минимуму (больше 2kb) 
    [api] › tests.spec.ts:197:3 › Проверка загрузки файлов › Проверка метаданных загружаемого изображения 
    [api] › tests.spec.ts:220:3 › Общие проверки › cors() содержит параметры и не пустой ───────────
    [api] › tests.spec.ts:248:3 › Общие проверки › Установлен рейт-лимит ───────────────────────────
  5 passed (2.1m)
Error: Process completed with exit code 1.